{"version":3,"sources":["redux/actions/actions-project.js","redux/default-data/index.js","redux/reducers/reducer-project.js","redux/store.js","components/header/index.jsx","components/footer/index.jsx","dnd/item-types.js","components/note/index.jsx","components/note-in-keyboard/index.jsx","components/keyboard/accidentalOctave/index.jsx","components/keyboard/naturalOctave/index.jsx","components/keyboard/index.jsx","components/note-column/index.jsx","redux/selectors/index.js","components/project-btn/index.jsx","components/note-in-bucket/index.jsx","components/bucket/index.jsx","components/bucketContainer/index.jsx","components/bucketRow/index.jsx","components/track/index.jsx","components/tracks/index.jsx","components/editable-text/index.jsx","components/project/index.jsx","components/app/index.jsx","redux/observers/index.js","sequencer/track.js","sequencer/utils.js","index.js","sequencer/index.js"],"names":["UPDATE_TEST_NOTE","CHANGE_PROJECT_NAME","CHANGE_PROJECT_BPM","PLAY","STOP","ADD_TRACK","ADD_NOTE","UPDATE_CURRENT_NOTE","DELETE_BUCKET","ADD_BUCKET","INIT_PROIECT","SPEED_FUTURE","MARIO","updateTestNote","on","value","type","payload","play","stop","addNote","id","index","bucketId","trackId","starterData","id1","uuidv4","bpm","name","playing","testNote","shared","tracks","sequence","nextId","baseNote","muted","soloed","currentNote","volume","synth","oscillator","detune","envelope","attack","decay","sustain","release","filter","frequency","resonance","defaultTrack","num","store","createStore","newState","state","action","newTracks","trackKeys","Object","keys","length","JSON","parse","stringify","noteObj","splice","push","noteIndex","trackId_update","newStateTracks","createNewProject","Header","className","Component","Footer","href","target","rel","Note","generateColor","noteValue","note","output","charCodeAt","intFromNote","color","2","3","4","5","6","map","colorValue","this","props","active","style","backgroundColor","NoteInKeyboard","testNoteOn","testNoteOff","connectDragSource","connectDropTarget","onMouseDown","onMouseUp","onDragStart","noteInKeyboardTarget","drop","monitor","console","log","getDropResult","keyboard","NoteInKeyboard_DDT","DropTarget","ItemTypes","connect","dropTarget","NoteInKeyboard_DS","DragSource","beginDrag","source","endDrag","didDrop","dragSource","state1","dispatch","actions","bindActionCreators","AccidentalOctave","renderAccidentals","arr","i","octave","NaturalOctave","Keyboard","NoteColumn","selectTestNote","selectBpm","selectPlaying","selectTracks","selectTrack","selectSequence","selectProjectIdAndTrackCount","mapDispatchToProps","changeProjectBpm","ProjectBtn","e","handlePlayStopClick","renderPlaying","onClick","min","max","onChange","htmlFor","NoteInBucket","opacity","isDragging","NoteInBucket_DT","hover","component","item","getItem","note_in_bucket","Bucket","notes","styleName","Notes","bucketTarget","dt_Bucket","ownProps","BucketContainer","deleteBtn","deleteBucket","BucketRow","handleAddBucketClick","addBucket","Buckets","bucket","title","Track","addTrack","Tracks","TrackMsg","values","track","EditableText","editing","handleClick","setState","handleSubmit","event","preventDefault","handleBlur","onBlur","handleChange","focusInput","textInput","focus","select","preProps","preState","onSubmit","ref","input","changeProjectName","initProject","toSpeed_fuTure_","toMario","Project","changeToSpeed_fuTure_","changeToMario","icon","SaveOutlined","size","EditOutlined","dt_Project","App","ddc_App","DndProvider","backend","HTML5Backend","selector","currentState","getState","error","subscribe","onSequenceChange","part","removeAll","initPart","Tone","toMaster","subscriptions","observeStore","partProcessor","bind","events","arg","forEach","bucketIndex","bucketLength","_dur","dur","start","getDurAndTime","time","createPartEvents","loop","loopEnd","triggerAttackRelease","updateCurrentNote","unsubscribe","dispose","handleBpmChange","handleTestNoteChange","triggerAttack","triggerRelease","handlePlayingChange","handleProjectIdOrTrackCountChange","deleteSelf","generateTracks","document","documentElement","addEventListener","resume","ReactDOM","render","getElementById"],"mappings":"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","file":"static/js/main.722c011e.chunk.js","sourcesContent":["export const UPDATE_TEST_NOTE = 'update_test_note'\r\nexport const CHANGE_PROJECT_NAME = 'change_project_name'\r\nexport const CHANGE_PROJECT_BPM = 'change_project_bpm'\r\nexport const PLAY = 'play'\r\nexport const STOP = 'stop'\r\nexport const ADD_TRACK = 'add_track'\r\nexport const ADD_NOTE = 'add_note'\r\nexport const UPDATE_CURRENT_NOTE = 'update_current_note';\r\nexport const DELETE_BUCKET = 'delete_bucket';\r\nexport const ADD_BUCKET = 'add_bucket';\r\nexport const INIT_PROIECT = 'init_project';\r\nexport const SPEED_FUTURE = 'speed_future_';\r\nexport const MARIO = 'mario';\r\n\r\n\r\n\r\n// payload 加载的action\r\nexport const updateTestNote = ({ on, value }) => {\r\n    return {\r\n        type: UPDATE_TEST_NOTE,\r\n        // 加载\r\n        payload: { on, value }\r\n    }\r\n}\r\n\r\n// 改名\r\nexport const changeProjectName = (name) => {\r\n    return {\r\n        type: CHANGE_PROJECT_NAME,\r\n        name\r\n    }\r\n}\r\n\r\n// 改bpm\r\nexport const changeProjectBpm = (bpm) => {\r\n    return {\r\n        type: CHANGE_PROJECT_BPM,\r\n        bpm\r\n    }\r\n}\r\n\r\n// 播放\r\nexport const play = () => {\r\n    return {\r\n        type: PLAY,\r\n    }\r\n}\r\n\r\n// 暂停\r\nexport const stop = () => {\r\n    return {\r\n        type: STOP,\r\n    }\r\n}\r\n\r\n// 添加track\r\nexport const addTrack = () => {\r\n    return {\r\n        type: ADD_TRACK,\r\n    }\r\n}\r\n\r\n// 在bucket中添加Note，需要bucketId, trackId\r\nexport const addNote = ({ value, id = null, index, bucketId, trackId }) => {\r\n    return {\r\n        type: ADD_NOTE,\r\n        payload: { value, id, index, bucketId, trackId }\r\n    }\r\n}\r\n\r\n// 更新当前正在播放的note，是一个数组，currentNote[0]是当前拍子，currentNote[1]是当前音符\r\nexport function updateCurrentNote({ bucketId, noteIndex, trackId }) {\r\n    return {\r\n        type: UPDATE_CURRENT_NOTE,\r\n        payload: { bucketId, noteIndex, trackId }\r\n    };\r\n}\r\n\r\n// 删除一个bucket\r\nexport function deleteBucket({ bucketId, trackId }) {\r\n    return {\r\n        type: DELETE_BUCKET,\r\n        payload: { bucketId, trackId }\r\n    }\r\n}\r\n\r\n// 添加一个bucket\r\nexport function addBucket(trackId) {\r\n    return {\r\n        type: ADD_BUCKET,\r\n        payload: { trackId }\r\n    }\r\n}\r\n\r\n// 新建空白乐章\r\nexport function initProject(){\r\n    return{\r\n        type:INIT_PROIECT,\r\n    }\r\n}\r\n\r\n// 换体验曲目Speed_fuTure_\r\nexport function toSpeed_fuTure_(){\r\n    return{\r\n        type:SPEED_FUTURE,\r\n    }\r\n}\r\n\r\n// 换体验曲目Speed_fuTure_\r\nexport function toMario(){\r\n    return{\r\n        type:MARIO,\r\n    }\r\n}\r\n","import { v4 as uuidv4 } from 'uuid'\r\n\r\n// mario的初始滤波器，里面是提前设置好的一种效果，是tone.js内置的\r\nexport const defaultFilter = () => ({\r\n    // 频率\r\n    frequency: 20000,\r\n    type: 'lowpass',\r\n    // 共振率\r\n    resonance: 1\r\n});\r\n\r\n// mario的初始合成器\r\nexport const defaultSynth = () => ({\r\n    // 振荡器\r\n    oscillator: {\r\n        // 振荡器类型\r\n        type: 'triangle',\r\n        // 去谐率\r\n        detune: 0\r\n    },\r\n    // 封装器 envelope 是一个ADSR封装器发生器。\r\n    // 封装器输出一个可以连接到AudioParam或Tone.signal的信号。\r\n    envelope: {\r\n        attack: 0.005,\r\n        // 衰减率\r\n        decay: 0.1,\r\n        // 持续，延音效果\r\n        sustain: 0.3,\r\n        // 释放？啥意思\r\n        release: 1\r\n    }\r\n});\r\n\r\nexport function starterData() {\r\n    const id1 = uuidv4();\r\n    // const id2 = uuidv4();\r\n    return {\r\n        bpm: 100,\r\n        name: 'New Project',\r\n        playing: false,\r\n        testNote: { on: false, value: '' },\r\n        shared: false,\r\n        tracks: {\r\n            //   加[]括号是为了动态的id1\r\n            [id1]: {\r\n                name: 'Track 1',\r\n                sequence: [\r\n                    [],\r\n                    [],\r\n                    [],\r\n                    [],\r\n                    [],\r\n                    [],\r\n                    [],\r\n                    [],\r\n                ],\r\n                nextId: 9,\r\n                baseNote: 4,\r\n                id: id1,\r\n                muted: false,\r\n                soloed: false,\r\n                currentNote: [],\r\n                volume: -8,\r\n                synth: defaultSynth(),\r\n                filter: defaultFilter()\r\n            },\r\n            // [id2]: {\r\n            //     name: 'Track 1',\r\n            //     sequence: [\r\n            //         [],\r\n            //         [],\r\n            //         [],\r\n            //         [],\r\n            //         [],\r\n            //         [],\r\n            //         [],\r\n            //         [],\r\n            //     ],\r\n            //     nextId: 9,\r\n            //     baseNote: 4,\r\n            //     id: id2,\r\n            //     muted: false,\r\n            //     soloed: false,\r\n            //     currentNote: [],\r\n            //     volume: -8,\r\n            //     synth: defaultSynth(),\r\n            //     filter: defaultFilter()\r\n            // },\r\n        }\r\n    };\r\n}\r\n\r\nexport const defaultTrack = (num, id) => ({\r\n    name: `Track ${num}`,\r\n    sequence: [[], [], [], [], [], [], [], []],\r\n    nextId: 0,\r\n    baseNote: 4,\r\n    id,\r\n    muted: false,\r\n    soloed: false,\r\n    currentNote: [],\r\n    volume: 0,\r\n    synth: defaultSynth(),\r\n    filter: defaultFilter()\r\n});\r\n\r\n\r\nexport function mario() {\r\n    return {\r\n        bpm: 100,\r\n        name: 'mario',\r\n        tracks: {\r\n            // 用uuid生成的id\r\n            '4ebd49bd-114c-46ab-a346-805eb554f1ef': {\r\n                // 几分音符？好像是，这里是2对应的却是8分音符的图标\r\n                // baseNote是8的时候对应的却是2分音符的图标\r\n                baseNote: 2,\r\n                // 播放的当前音符，是否处于这个bucket，用来判断当前拍子是否高亮\r\n                // 判断当前音符是否高亮，要看当前拍子是否高亮而且是否到了当前音符\r\n                // currentNote[0]是当前拍子，currentNote[1]是当前音符\r\n                currentNote: [],\r\n                id: '4ebd49bd-114c-46ab-a346-805eb554f1ef',\r\n                muted: false,\r\n                name: 'Coin',\r\n                nextId: 17,\r\n                sequence: [\r\n                    [],\r\n                    [\r\n                        { id: 13, value: 'rest' },\r\n                        { id: 16, value: 'rest' },\r\n                        { id: 11, value: 'rest' },\r\n                        { id: 14, value: 'B5' }\r\n                    ],\r\n                    [{ id: 15, value: 'E6' }],\r\n                    [],\r\n                    [],\r\n                    [],\r\n                    [],\r\n                    [],\r\n                ],\r\n                soloed: false,\r\n                volume: -20,\r\n                synth: defaultSynth(),\r\n                filter: defaultFilter()\r\n            },\r\n            'bcfbc2d3-4e04-436a-8767-37353a0c4696': {\r\n                baseNote: 4,\r\n                currentNote: [],\r\n                id: 'bcfbc2d3-4e04-436a-8767-37353a0c4696',\r\n                muted: false,\r\n                name: 'High Melody',\r\n                nextId: 50,\r\n                sequence: [\r\n                    [\r\n                        { id: 9, value: 'C5' },\r\n                        { id: 10, value: 'rest' },\r\n                        { id: 11, value: 'rest' },\r\n                        { id: 12, value: 'G4' }\r\n                    ],\r\n                    [\r\n                        { id: 23, value: 'rest' },\r\n                        { id: 14, value: 'rest' },\r\n                        { id: 13, value: 'E4' },\r\n                        { id: 24, value: 'rest' }\r\n                    ],\r\n                    [\r\n                        { id: 25, value: 'rest' },\r\n                        { id: 27, value: 'A4' },\r\n                        { id: 26, value: 'rest' },\r\n                        { id: 28, value: 'B4' }\r\n                    ],\r\n                    [\r\n                        { id: 29, value: 'rest' },\r\n                        { id: 30, value: 'A#4' },\r\n                        { id: 31, value: 'A4' },\r\n                        { id: 32, value: 'rest' }\r\n                    ],\r\n                    [\r\n                        { id: 33, value: 'G4' },\r\n                        { id: 34, value: 'E5' },\r\n                        { id: 35, value: 'G5' }\r\n                    ],\r\n                    [\r\n                        { id: 36, value: 'A5' },\r\n                        { id: 37, value: 'rest' },\r\n                        { id: 38, value: 'F5' },\r\n                        { id: 39, value: 'G5' }\r\n                    ],\r\n                    [\r\n                        { id: 40, value: 'rest' },\r\n                        { id: 41, value: 'E5' },\r\n                        { id: 15, value: 'rest' },\r\n                        { id: 42, value: 'C5' }\r\n                    ],\r\n                    [\r\n                        { id: 43, value: 'D5' },\r\n                        { id: 44, value: 'B4' },\r\n                        { id: 17, value: 'rest' },\r\n                        { id: 22, value: 'rest' }\r\n                    ]\r\n                ],\r\n                soloed: false,\r\n                volume: 2,\r\n                synth: defaultSynth(),\r\n                filter: defaultFilter()\r\n            },\r\n            'cba856c2-2d3b-4fb5-b31e-0a430c713f90': {\r\n                baseNote: 4,\r\n                currentNote: [],\r\n                id: 'cba856c2-2d3b-4fb5-b31e-0a430c713f90',\r\n                muted: false,\r\n                name: 'Harmony Melody',\r\n                nextId: 42,\r\n                sequence: [\r\n                    [\r\n                        { id: 0, value: 'E4' },\r\n                        { id: 2, value: 'rest' },\r\n                        { id: 1, value: 'rest' },\r\n                        { id: 3, value: 'C4' }\r\n                    ],\r\n                    [\r\n                        { id: 5, value: 'rest' },\r\n                        { id: 4, value: 'rest' },\r\n                        { id: 6, value: 'G3' },\r\n                        { id: 7, value: 'rest' }\r\n                    ],\r\n                    [\r\n                        { id: 8, value: 'rest' },\r\n                        { id: 9, value: 'C4' },\r\n                        { id: 10, value: 'rest' },\r\n                        { id: 11, value: 'D4' }\r\n                    ],\r\n                    [\r\n                        { id: 13, value: 'rest' },\r\n                        { id: 32, value: 'C#4' },\r\n                        { id: 15, value: 'C4' },\r\n                        { id: 12, value: 'rest' }\r\n                    ],\r\n                    [\r\n                        { id: 16, value: 'C4' },\r\n                        { id: 17, value: 'G4' },\r\n                        { id: 18, value: 'B4' }\r\n                    ],\r\n                    [\r\n                        { id: 31, value: 'C5' },\r\n                        { id: 20, value: 'rest' },\r\n                        { id: 21, value: 'A4' },\r\n                        { id: 22, value: 'B4' }\r\n                    ],\r\n                    [\r\n                        { id: 23, value: 'rest' },\r\n                        { id: 24, value: 'A4' },\r\n                        { id: 25, value: 'rest' },\r\n                        { id: 26, value: 'E4' }\r\n                    ],\r\n                    [\r\n                        { id: 27, value: 'F4' },\r\n                        { id: 28, value: 'D4' },\r\n                        { id: 29, value: 'rest' },\r\n                        { id: 30, value: 'rest' }\r\n                    ]\r\n                ],\r\n                soloed: false,\r\n                volume: -6,\r\n                synth: defaultSynth(),\r\n                filter: defaultFilter()\r\n            },\r\n            'cdf1002a-1c03-4f50-915d-7c7b3764d961': {\r\n                baseNote: 8,\r\n                currentNote: [],\r\n                id: 'cdf1002a-1c03-4f50-915d-7c7b3764d961',\r\n                muted: false,\r\n                name: 'Bass',\r\n                nextId: 37,\r\n                sequence: [\r\n                    [{ id: 14, value: 'C3' }, { id: 32, value: 'G2' }],\r\n                    [{ id: 33, value: 'F2' }, { id: 34, value: 'E2' }],\r\n                    [{ id: 22, value: 'E3' }, { id: 23, value: 'F3' }],\r\n                    [{ id: 27, value: 'E3' }, { id: 28, value: 'D3' }]\r\n                ],\r\n                soloed: false,\r\n                volume: 0,\r\n                synth: defaultSynth(),\r\n                filter: defaultFilter()\r\n            }\r\n        },\r\n        // 是否正在播放\r\n        playing: false,\r\n        // 在右侧进行点击试听的\r\n        testNote: {\r\n            on: false,\r\n            value: ''\r\n        }\r\n    }\r\n}\r\nexport function Speed_fuTure_() {\r\n    return {\r\n      bpm: 60,\r\n      name: 'Speed-fuTure-',\r\n      // 线上功能的分享\r\n      shared: false,\r\n      // 音轨\r\n      tracks: {\r\n        // 用uuid生成的id\r\n        '4ebd49bd-114c-46ab-a346-805eb554f1ef': {\r\n          // 几分音符？好像是，这里是2对应的却是8分音符的图标\r\n          // baseNote是8的时候对应的却是2分音符的图标\r\n          baseNote: 4,\r\n          currentNote: [],\r\n          id: '4ebd49bd-114c-46ab-a346-805eb554f1ef',\r\n          muted: false,\r\n          name: 'Coin',\r\n          // 这个用来干嘛\r\n          nextId: 17,\r\n          sequence: [\r\n            [\r\n              { id: 9, value: \"E4\" },\r\n              { id: 9, value: \"B4\" },\r\n              { id: 9, value: \"G4\" },\r\n              { id: 9, value: \"B4\" }\r\n            ],\r\n  \r\n  \r\n            [\r\n              { id: 9, value: \"E5\" },\r\n              { id: 9, value: \"B4\" },\r\n              { id: 9, value: \"G4\" },\r\n              { id: 9, value: \"B4\" },\r\n            ],\r\n  \r\n            [\r\n              { id: 9, value: \"C4\" },\r\n              { id: 9, value: \"G4\" },\r\n              { id: 9, value: \"E4\" },\r\n              { id: 9, value: \"G4\" }\r\n            ],\r\n  \r\n  \r\n            [\r\n              { id: 9, value: \"C5\" },\r\n              { id: 9, value: \"G4\" },\r\n              { id: 9, value: \"E4\" },\r\n              { id: 9, value: \"G4\" }\r\n            ],\r\n  \r\n            [\r\n              { id: 9, value: \"D4\" },\r\n              { id: 9, value: \"A4\" },\r\n              { id: 9, value: \"F#4\" },\r\n              { id: 9, value: \"A4\" }\r\n            ],\r\n            [\r\n              { id: 9, value: \"D5\" },\r\n              { id: 9, value: \"A4\" },\r\n              { id: 9, value: \"F#4\" },\r\n              { id: 9, value: \"A4\" }\r\n            ],\r\n  \r\n            [\r\n              { id: 9, value: \"B3\" },\r\n              { id: 9, value: \"F#4\" },\r\n              { id: 9, value: \"D4\" },\r\n              { id: 9, value: \"F#4\" }\r\n            ],\r\n  \r\n  \r\n            [\r\n              { id: 9, value: \"B4\" },\r\n              { id: 9, value: \"F#4\" },\r\n              { id: 9, value: \"D4\" },\r\n              { id: 9, value: \"F#4\" }\r\n            ],\r\n          ],\r\n          soloed: false,\r\n          volume: -20,\r\n          synth: defaultSynth(),\r\n          filter: defaultFilter()\r\n        },\r\n        'bcfbc2d3-4e04-436a-8767-37353a0c4696': {\r\n          baseNote: 4,\r\n          currentNote: [],\r\n          id: 'bcfbc2d3-4e04-436a-8767-37353a0c4696',\r\n          muted: false,\r\n          name: 'High Melody',\r\n          nextId: 50,\r\n          sequence: [\r\n            [],\r\n            [],\r\n            [],\r\n            [],\r\n            [],\r\n            [],\r\n            [],\r\n            [],\r\n  \r\n            [\r\n              { id: 0, value: \"E4\" },\r\n              { id: 0, value: \"E4\" },\r\n              { id: 0, value: \"rest\" },\r\n              { id: 0, value: \"rest\" },\r\n            ],\r\n            [],\r\n  \r\n            [\r\n              { id: 9, value: \"G3\" },\r\n              { id: 9, value: \"G3\" },\r\n              { id: 9, value: \"rest\" },\r\n              { id: 9, value: \"rest\" }\r\n            ],\r\n            [],\r\n  \r\n            [\r\n              { id: 9, value: \"A3\" },\r\n              { id: 9, value: \"A3\" },\r\n              { id: 9, value: \"rest\" },\r\n              { id: 9, value: \"rest\" }\r\n            ],\r\n            [],\r\n            [\r\n              { id: 9, value: \"E3\" },\r\n              { id: 9, value: \"E3\" },\r\n              { id: 9, value: \"rest\" },\r\n              { id: 9, value: \"rest\" }\r\n            ],\r\n            [],\r\n          ],\r\n          soloed: false,\r\n          volume: 2,\r\n          synth: defaultSynth(),\r\n          filter: defaultFilter()\r\n        },\r\n        'cba856c2-2d3b-4fb5-b31e-0a430c713f90': {\r\n          baseNote: 4,\r\n          currentNote: [],\r\n          id: 'cba856c2-2d3b-4fb5-b31e-0a430c713f90',\r\n          muted: false,\r\n          name: 'Harmony Melody',\r\n          nextId: 42,\r\n          sequence: [\r\n            [],\r\n            [],\r\n            [],\r\n            [],\r\n            [],\r\n            [],\r\n            [],\r\n            [],\r\n  \r\n            [\r\n              { id: 0, value: \"B4\" },\r\n              { id: 0, value: \"B4\" },\r\n              { id: 0, value: \"rest\" },\r\n              { id: 0, value: \"rest\" },\r\n            ],\r\n            [],\r\n  \r\n            [\r\n              { id: 9, value: \"C3\" },\r\n              { id: 9, value: \"C3\" },\r\n              { id: 9, value: \"rest\" },\r\n              { id: 9, value: \"rest\" }\r\n            ],\r\n            [],\r\n  \r\n            [\r\n              { id: 9, value: \"D3\" },\r\n              { id: 9, value: \"D3\" },\r\n              { id: 9, value: \"rest\" },\r\n              { id: 9, value: \"rest\" }\r\n            ],\r\n            [],\r\n            [\r\n              { id: 9, value: \"B2\" },\r\n              { id: 9, value: \"B2\" },\r\n              { id: 9, value: \"rest\" },\r\n              { id: 9, value: \"rest\" }\r\n            ],\r\n            [],\r\n          ],\r\n          soloed: false,\r\n          volume: -6,\r\n          synth: defaultSynth(),\r\n          filter: defaultFilter()\r\n        },\r\n      },\r\n      // 是否正在播放\r\n      playing: false,\r\n      // 在右侧进行点击试听的\r\n      testNote: {\r\n        on: false,\r\n        value: ''\r\n      }\r\n    };\r\n  }\r\n  ","import {\r\n    UPDATE_TEST_NOTE,\r\n    CHANGE_PROJECT_NAME,\r\n    CHANGE_PROJECT_BPM,\r\n    STOP,\r\n    PLAY,\r\n    ADD_TRACK,\r\n    ADD_NOTE,\r\n    UPDATE_CURRENT_NOTE,\r\n    DELETE_BUCKET,\r\n    ADD_BUCKET,\r\n    INIT_PROIECT,\r\n    SPEED_FUTURE,\r\n    MARIO,\r\n\r\n} from '../actions/actions-project'\r\nimport { mario, defaultTrack, starterData, Speed_fuTure_ } from '../default-data'\r\nimport { v4 as uuidv4 } from 'uuid'\r\n\r\n\r\n// eslint-disable-next-line\r\nexport default (state = mario(), action) => {\r\n    // newState作为一个闭包的变量进行增删改查\r\n    let newState\r\n    // 能不能在这里进行newState = { ...state }，每一次处理action\r\n    // 都会走一遍这个函数，下面试验一下\r\n    //这个是浅拷贝，只能复制对象里的非对象普通数据\r\n    // 但是里面的tracks是对象，还是指向的原来的tracks，里面的sequence就更没变了\r\n\r\n    newState = { ...state }\r\n\r\n    // 以下是测试用的深拷贝,经过测试结果，得到就是因为这个原因，导致无法正常添加\r\n    // newState = JSON.parse(JSON.stringify(state))\r\n\r\n\r\n    switch (action.type) {\r\n        case UPDATE_TEST_NOTE:\r\n            // console.log('state', state);\r\n            // newState = { ...state }\r\n            // note写成了node\r\n            newState.testNote = action.payload\r\n            // console.log('newState', newState);\r\n            return newState\r\n        case CHANGE_PROJECT_NAME:\r\n            // newState = { ...state }\r\n            newState.name = action.name\r\n            return newState\r\n        case CHANGE_PROJECT_BPM:\r\n            newState.bpm = action.bpm\r\n            return newState\r\n        case STOP:\r\n            newState.playing = false\r\n            return newState\r\n        case PLAY:\r\n            newState.playing = true\r\n            return newState\r\n\r\n        case ADD_TRACK://不要用深拷贝\r\n            // 不用用深拷贝，这个添加一个新的track，不能改变之前的，因为一旦改变之前的，会进行part.removeAll()，\r\n            // 但是又全部换成了新的，就会出错\r\n            // newState = JSON.parse(JSON.stringify(state))\r\n\r\n            const newTracks = { ...newState.tracks }\r\n            const trackKeys = Object.keys(newTracks)\r\n            const id = uuidv4()\r\n            newTracks[id] = defaultTrack(trackKeys.length + 1, id)\r\n            // 把新tracks给新state\r\n            newState.tracks = newTracks\r\n            return newState\r\n        case ADD_NOTE://要用深拷贝\r\n            newState = JSON.parse(JSON.stringify(state))\r\n\r\n            let { value, index, bucketId, trackId } = action.payload\r\n            const noteObj = { id: action.payload.id, value }\r\n\r\n            // 给指定bucket中添加note音符\r\n            newState.tracks[trackId].sequence[bucketId].splice(index, 0, noteObj)\r\n\r\n            return newState\r\n\r\n        case DELETE_BUCKET:\r\n            // 删除的bucket处于sequence之下，所以差不多是最深层了，要用深拷贝\r\n            newState = JSON.parse(JSON.stringify(state))\r\n\r\n            // 不能这样写，因为有可能删除的时候在上面的let还没有经过，bucketId还未声明\r\n            // bucketId = action.payload.bucketId\r\n            // trackId = action.payload.trackId\r\n\r\n\r\n            // 删除指定的bucket,变量只能挨着.下去\r\n            newState.tracks[action.payload.trackId].sequence.splice(action.payload.bucketId, 1)\r\n\r\n            // 判断当前sequence里面还有没有bucket\r\n            // if(newState.tracks[action.payload.trackId].sequence.length===0){\r\n            //     // 如果已经没有了，就删除这个track\r\n\r\n            //     // 但是这样写，又会想之前那样出现 Cannot read property 'removeAll' of null的错误，因为深拷贝了\r\n            //     // 所以要删除这个track又不能改变其他的track，要么就是保留这个track，只是不渲染\r\n            //     // 要么就是只删除这个track，不引起其他track 的sequence变化，但是track一删除就会\r\n            //     delete newState.tracks[action.payload.trackId]\r\n            // }\r\n\r\n            return newState\r\n        case ADD_BUCKET:\r\n            // 添加同样需要深拷贝\r\n            newState = JSON.parse(JSON.stringify(state))\r\n\r\n            // 在指定track的sequence末尾添加一个空白数组\r\n            newState.tracks[action.payload.trackId].sequence.push([])\r\n\r\n            return newState\r\n\r\n\r\n\r\n\r\n\r\n        case UPDATE_CURRENT_NOTE://不用深拷贝，但是却要拷贝到深一层，不能改变sequence\r\n\r\n            const { noteIndex } = action.payload\r\n            const trackId_update = action.payload.trackId\r\n            // 所以要一层一层传入并返回，相当于是每一层都进行浅拷贝\r\n\r\n            // 第一层\r\n            const newStateTracks = { ...newState.tracks }\r\n            newState.tracks = newStateTracks\r\n\r\n            // 第二层,把tracks[id]浅拷贝一个，里面的sequence就不拷贝了\r\n            newStateTracks[trackId_update] = { ...newStateTracks[trackId_update] }\r\n            // newState.tracks[trackId_update].currentNote = [action.payload.bucketId, noteIndex]\r\n\r\n            newStateTracks[trackId_update].currentNote = [action.payload.bucketId, noteIndex]\r\n            return newState\r\n\r\n        case INIT_PROIECT:\r\n            // 当只有一个音轨的时候，就改掉那一个，如果有两个及以上，就新建\r\n            if (Object.keys(state.tracks).length !== 1) {\r\n                // console.log(Object.keys(state.tracks).length);\r\n                newState = { ...starterData() }\r\n                // const [id1] = Object.keys(newState.tracks);\r\n                // delete newState.tracks[id2];\r\n                // newState.tracks[id1].sequence = [[], [], [], [], [], [], [], []];\r\n                return newState;\r\n            }\r\n\r\n            /* \r\n                这种思路太乱了，而且写在这里的变量容易污染环境，最好是在一个函数里面写\r\n            */\r\n            //#region \r\n            // const [id1] = Object.keys(newState.tracks);\r\n            // const newStateTracks2 = { ...newState.tracks }\r\n            // newState.tracks = newStateTracks2\r\n            // const newStateTracksTrack = { ...newStateTracks2[id1] }\r\n            // newStateTracks2[id1] = newStateTracksTrack\r\n            // let newSequence = { ...newStateTracksTrack.sequence }\r\n            // newStateTracksTrack.sequence = newSequence\r\n            // newSequence = [\r\n            //     [],\r\n            //     [],\r\n            //     [],\r\n            //     [],\r\n            //     [],\r\n            //     [],\r\n            //     [],\r\n            //     [],\r\n            // ]\r\n            //#endregion\r\n\r\n            // 第二次以及后面的新建,并且还是只有一个音轨，就直接改那个音轨为空白就行\r\n            createNewProject()\r\n            return newState;\r\n\r\n        case SPEED_FUTURE:\r\n            newState = { ...Speed_fuTure_() }\r\n            return newState;\r\n        case MARIO:\r\n            newState = { ...mario() }\r\n            return newState;\r\n\r\n        default:\r\n\r\n            return state\r\n    }\r\n    function createNewProject() {\r\n        newState.playing = false\r\n        newState.tracks = { ...newState.tracks }\r\n        const id = Object.keys(newState.tracks)[0]\r\n        newState.tracks[id] = { ...newState.tracks[id] }\r\n        newState.tracks[id].sequence = [[], [], [], [], [], [], [], [],]\r\n    }\r\n}\r\n","import { createStore, applyMiddleware, compose } from 'redux'\r\nimport reducers from './reducers/reducer-project'\r\nimport thunk from 'redux-thunk'\r\n\r\n// 异步处理的thunk还未install，占时不必引入\r\n\r\n// console.log(process.env.NODE_ENV);\r\n// console.log(__REDUX_DEVTOOLS_EXTENSION__);\r\n\r\n\r\n// 如果是在开发环境下，会用上devtools，如果是在生产环境就不用\r\nlet store = process.env.NODE_ENV === 'development' ? (\r\n    createStore(reducers, compose(applyMiddleware(thunk), window.__REDUX_DEVTOOLS_EXTENSION__()))\r\n) : createStore(reducers)\r\n\r\nexport default store","import React, { Component } from 'react'\r\nimport './index.css'\r\n// import './index1.css'\r\n\r\nexport default class Header extends Component {\r\n    render() {\r\n        return (\r\n            <div className=\"header\">\r\n                <span className=\"header-title\">\r\n                    Acoustica-mixer\r\n                </span>\r\n            </div>\r\n        )\r\n    }\r\n}\r\n","import React, { Component } from 'react'\r\nimport './index.css'\r\n\r\nexport default class Footer extends Component {\r\n    render() {\r\n        return (\r\n            <div className='rc-footer'>\r\n                <div className='beian'>\r\n                    <a href=\"https://beian.miit.gov.cn/\" target=\"_blank\" rel=\"noreferrer\">渝ICP备2021005847号-1</a>\r\n                </div>\r\n            </div>\r\n        )\r\n    }\r\n}\r\n","// 这种写法会报错，因为ES Module)和cjs(CommonJS)的互操作性。\r\n// 所以要么用eslint-disable-next-line，要么单独写,然后不用default\r\n\r\n// eslint-disable-next-line\r\nexport default {\r\n    NOTE:'note'\r\n}\r\n\r\n// 不用default的话，外部引入的时候就要加中括号了\r\n// const NOTE = 'note';\r\n// export  {\r\n//     NOTE\r\n// }\r\n","import React, { Component } from 'react'\r\nimport './index.css'\r\n\r\n\r\nconst renderNoteValue = (noteValue) => {\r\n    if (noteValue.length === 3)\r\n        return <span>{noteValue[0]}<sup className=\"sharp\">♯</sup>{noteValue[2]}</span>;\r\n    return <span>{noteValue}</span>;\r\n}\r\n\r\nexport default class Note extends Component {\r\n\r\n    generateColor = (noteValue) => {\r\n        function intFromNote(note) {\r\n            // 返回字符串首个字符的Unicode编码，不写index就是返回首位\r\n            /* \r\n              A  B  C  D  E  F  G\r\n              65 66 67 68 69 70 71 \r\n            */\r\n            let output = note.charCodeAt();\r\n            // 为什么要遇到AB加7，因为音律排列不是abcdefg，是cdefgab\r\n            /* \r\n              C  D  E  F  G     A       B  \r\n              67 68 69 70 71 65+7=72 66+7=73\r\n              即是\r\n              C  D  E  F  G  A  B  \r\n              67 68 69 70 71 72 73\r\n          \r\n            */\r\n            if (note === 'A' || note === 'B')\r\n                output += 7;\r\n\r\n            // 然后再减去66，从1开始算\r\n\r\n            /* \r\n              C  D  E  F  G  A  B  \r\n              1  2  3  4  5  6  7\r\n            */\r\n            output -= 66;\r\n            return output;\r\n        }\r\n\r\n        // noteValue要么是C2这种音符，要么是rest休止符\r\n\r\n        // 如果是rest休止符，那么颜色是蓝绿色\r\n        if (noteValue === 'rest')\r\n            return '#4C9393';\r\n\r\n        // 5个八度音阶，分为23456，比如C2、D2、C3、D3等，后面的数组是先确定好的rgb值\r\n        const octaveColors = {\r\n            2: [50, 60, 120],\r\n            3: [70, 50, 100],\r\n            4: [100, 40, 70],\r\n            5: [120, 30, 10],\r\n            6: [170, 50, 0]\r\n        };\r\n\r\n        // 取C2这种字符串的第一位字符C，然后intFromNote(C)输出1,确定当前note是八度音中具体哪一个音，duo、ruo、mi==C、D、E=1、2、3\r\n        // 对应如下，所以会输入一个7以内的数，然后去对应上面的rgb表\r\n        /* \r\n        C  D  E  F  G  A  B  \r\n        1  2  3  4  5  6  7\r\n      */\r\n        const note = intFromNote(noteValue[0]);\r\n\r\n        // 确定是哪一个八度音，比如C2的2，就是低音C4就是正常的音调，C6就是高音\r\n        const octave = noteValue[noteValue.length - 1];\r\n\r\n        // 上色，根据octave，选出rgb数组，比如2: [50, 60, 120]的[50, 60, 120],然后+ (note * 10)\r\n        // 比如如果是C2的话就是[50+10, 60+10, 120+10] 即 [60, 70, 130]\r\n        const color = octaveColors[octave].map(colorValue => colorValue + (note * 10));\r\n\r\n        return `rgb(${color[0]}, ${color[1]}, ${color[2]})`;\r\n    }\r\n\r\n\r\n\r\n\r\n    render() {\r\n        const { value, active } = this.props\r\n        let color = '#F4A53F'\r\n\r\n        if (!active) color = this.generateColor(value)\r\n        return (\r\n            <div className='note' style={{ backgroundColor: color }}>\r\n                {renderNoteValue(value)}\r\n            </div>\r\n        )\r\n    }\r\n}\r\n","import React, { Component } from 'react'\r\n\r\n// redux相关的\r\nimport { connect } from 'react-redux'\r\nimport { bindActionCreators } from 'redux'\r\n\r\n// dnd相关\r\nimport { DragSource, DropTarget } from 'react-dnd'\r\nimport ItemTypes from '../../dnd/item-types'\r\n\r\nimport {\r\n    updateTestNote,\r\n    addNote,\r\n    //  addTrack\r\n} from '../../redux/actions/actions-project'\r\n\r\n// css\r\nimport './index.css'\r\n\r\n// Note音符组件\r\nimport Note from '../note'\r\n// import Note from '../note/note'\r\n\r\n\r\n\r\n// 可以把下面的actions传进NoteInKeyboard组件当props\r\n// const mapDispatchToProps = { updateTestNote }\r\nconst mapDispatchToProps = (dispatch) => {\r\n    const actions = {\r\n        updateTestNote,\r\n        addNote\r\n    }\r\n    return bindActionCreators(actions, dispatch)\r\n}\r\n\r\nconst mapStateToProps = (state) => {\r\n    return {\r\n        testNote: state.testNote,\r\n        state1: state\r\n    }\r\n}\r\n\r\n// dnd的collect属性，把connectDragSource传进去当props，用这个包裹return才能进行drag\r\nfunction collect(connect) {\r\n    return {\r\n        connectDragSource: connect.dragSource()\r\n    };\r\n}\r\n\r\n\r\n\r\n// drag source spec function\r\n// 这是drag的spec属性,这个return 的在drop那边的spec里面能得到\r\nconst noteInKeyboardSource = {\r\n    beginDrag(props) {\r\n        // 返回的对象可以在 monitor.getItem()中取到，在drop里也可以取到\r\n        return {\r\n            value: props.value,\r\n            source: 'keyboard'\r\n        }\r\n    },\r\n\r\n    // 还差其他的函数，比如endDrag\r\n    endDrag(props, monitor) {\r\n        // 因为monitor.didDrop()在endDrag里面是ture，所以不需要进行判断monitor.didDrop()是否已经处理\r\n        // console.log('monitor.didDrop()', monitor.didDrop());\r\n        // console.log('monitor', monitor);\r\n\r\n        // console.log('getDropResult', monitor.getDropResult());\r\n        // console.log('getDropResult', monitor);\r\n        // console.log('getDropResult', monitor.getItem());\r\n        // console.log('x', monitor[x]);\r\n        // 只有被其他的解决了才会返回一个对象\r\n\r\n        if (monitor.didDrop()) {\r\n            // console.log('getDropResult', monitor.getDropResult());\r\n        }\r\n\r\n        // 为什么monitor.getDropResult()得不到想要的值？\r\n        /* \r\n        drop(){}中monitor.getDropResult()可以得到任意drag到此处来drop的元素\r\n        但是可以通过事件冒泡，外部部件drop到子组件，子组件drop()函数return一个对象，在父组件drop()里可以得到\r\n        \r\n        但是drag中endDrag(){}中getDropResult()只能得到同一组件既是drag又是drop 的里面drop()返回的对象\r\n        所以此处无法得到想要 的数据\r\n        */\r\n\r\n\r\n        // const { addNote, value } = props\r\n        // const { target } = monitor.getDropResult()\r\n        // console.log('getDropResult', monitor.getDropResult());\r\n        // if (target === 'bucket') {\r\n        //     addNote({\r\n        //         value,\r\n        //     })\r\n        // }\r\n    }\r\n};\r\n\r\nclass NoteInKeyboard extends Component {\r\n    constructor(props) {\r\n        super(props)\r\n        this.updateTestNote = this.props.updateTestNote\r\n    }\r\n\r\n\r\n    testNoteOn = () => {\r\n        if (this.props.value !== 'rest') {\r\n            // 为什么redux的devtool没变化，switch也没进入任何一项\r\n            this.updateTestNote({\r\n                on: true,\r\n                value: this.props.value,\r\n            })\r\n            // 确实是运行了，但是我认为是因为异步的关系，下面的输出还是没有变化\r\n            // console.log('---');\r\n        }\r\n        \r\n    }\r\n    testNoteOff = () => {\r\n        if (this.props.value !== 'rest') {\r\n            this.updateTestNote({\r\n                on: false,\r\n                value: this.props.value\r\n            })\r\n        }\r\n    }\r\n    render() {\r\n        const {\r\n            connectDragSource,\r\n            value,\r\n            connectDropTarget,\r\n        } = this.props\r\n        return connectDragSource(\r\n            connectDropTarget(\r\n                <div\r\n                    className={`note-in-keyboard`}\r\n                    onMouseDown={this.testNoteOn}\r\n                    // onClick={this.testNoteOn}\r\n                    onMouseUp={this.testNoteOff}\r\n                    onDragStart={this.testNoteOff}\r\n                >\r\n                    <Note value={value} />\r\n                </div>\r\n            ))\r\n    }\r\n}\r\n\r\nconst noteInKeyboardTarget = {\r\n    drop(props, monitor) {\r\n        console.log('drop', monitor.getDropResult());\r\n        return {\r\n            keyboard: 2\r\n        }\r\n    },\r\n\r\n}\r\nconst collectTarget = (connect) => {\r\n    return {\r\n        connectDropTarget: connect.dropTarget()\r\n    }\r\n}\r\n\r\nconst NoteInKeyboard_DDT = DropTarget(\r\n    ItemTypes.NOTE,\r\n    noteInKeyboardTarget,\r\n    collectTarget\r\n)(NoteInKeyboard)\r\n\r\nconst NoteInKeyboard_DS = DragSource(\r\n    ItemTypes.NOTE,\r\n    noteInKeyboardSource,\r\n    collect\r\n)(NoteInKeyboard_DDT)\r\n\r\nexport default connect(\r\n    mapStateToProps,\r\n    mapDispatchToProps\r\n)(NoteInKeyboard_DS)","import React, { Component } from 'react'\r\nimport NoteInKeyBoard from '../../note-in-keyboard'\r\n// import '../index.css'\r\n\r\n\r\n\r\nexport default class AccidentalOctave extends Component {\r\n\r\n    renderAccidentals = (arr) => {\r\n        return (\r\n            <div className={`keyboard-acc${arr.length}`} key={arr.length - 2}>\r\n                {\r\n                    arr.map((value, i) => <NoteInKeyBoard value={`${value}${this.props.octave}`} key={i} />)\r\n                }\r\n            </div>\r\n        )\r\n    }\r\n    render() {\r\n        const accidentalOctaves2 = ['C#', 'D#']\r\n        const accidentalOctaves3 = ['F#', 'G#', 'A#']\r\n        return [\r\n            this.renderAccidentals(accidentalOctaves2),\r\n            this.renderAccidentals(accidentalOctaves3)\r\n        ]\r\n    }\r\n}\r\n","import React, { Component } from 'react'\r\nimport NoteInKeyBoard from '../../note-in-keyboard'\r\n// import '../index.css'\r\n\r\nexport default class NaturalOctave extends Component {\r\n\r\n    \r\n    render() {\r\n        const naturals = ['C', 'D', 'E', 'F', 'G', 'A', 'B']\r\n        return naturals.map((value,i)=>{\r\n            return(\r\n                <NoteInKeyBoard value={`${value}${this.props.octave}`} key = {i}/>\r\n            )\r\n        })\r\n    }\r\n}\r\n","import React, { Component } from 'react'\r\nimport AccidentalOctave from './accidentalOctave'\r\nimport NaturalOctave from './naturalOctave'\r\nimport './index.css'\r\n\r\n\r\nexport default class Keyboard extends Component {\r\n    render() {\r\n        return (\r\n            <div className='Keyboard'>\r\n                <div className='keyboard-notes'>\r\n                    {/*  keyboard写成了大写导致样式无法正确配置，以后尽量复制*/}\r\n                    <div className='keyboard-col'>\r\n                        <NaturalOctave octave={2} />\r\n                        <NaturalOctave octave={3} />\r\n                        <NaturalOctave octave={4} />\r\n                        <NaturalOctave octave={5} />\r\n                        <NaturalOctave octave={6} />\r\n                    </div>\r\n                    <div className='keyboard-col'>\r\n                        <AccidentalOctave octave={2} />\r\n                        <AccidentalOctave octave={3} />\r\n                        <AccidentalOctave octave={4} />\r\n                        <AccidentalOctave octave='5' />\r\n                        <AccidentalOctave octave='6' />\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        )\r\n    }\r\n}\r\n","import React, { Component } from 'react'\r\nimport KeyBoard from '../keyboard'\r\nimport NoteInKeyboard from '../note-in-keyboard'\r\nimport './index.css'\r\n\r\nexport default class NoteColumn extends Component {\r\n    render() {\r\n        return (\r\n            <div className=\"note-column\">\r\n                <div className=\"rest-box\">\r\n                    {/* 这里的value传的是rest */}\r\n                    <NoteInKeyboard value=\"rest\" />\r\n                </div>\r\n                {/* 这里面会给其中的Note传C4等音符名 */}\r\n                <KeyBoard />\r\n            </div>\r\n        )\r\n    }\r\n}\r\n","export function selectTestNote(state) {\r\n    return state.testNote\r\n}\r\nexport function selectBpm(state) {\r\n    return state.bpm\r\n}\r\nexport function selectPlaying(state) {\r\n    return state.playing\r\n}\r\nexport function selectTracks(state) {\r\n    return state.tracks\r\n}\r\nexport function selectTrack(id) {\r\n    return state => state.tracks[id]\r\n}\r\nexport function selectNextId(trackId) {\r\n    return state => state.tracks[trackId].nextId\r\n}\r\nexport function selectSequence(id){\r\n    return state => state.tracks[id].sequence\r\n}\r\n\r\n// 复制的\r\nexport function selectProjectIdAndTrackCount(state) {\r\n    return `${state.id},${Object.keys(state.tracks).length}`;\r\n}\r\n","import React, { Component } from 'react'\r\n\r\nimport { connect } from 'react-redux'\r\nimport {\r\n    selectBpm,\r\n    selectPlaying,\r\n} from '../../redux/selectors'\r\n// redux的action\r\nimport {\r\n    changeProjectBpm,\r\n    play,\r\n    stop\r\n} from '../../redux/actions/actions-project'\r\nimport './index.css'\r\n\r\n// 两种情况，store传进来的bpm和父组件传进来的bpm谁覆盖谁，\r\n// 父组件的bpm也是store传给父组件的，当bpm改变的时候，传到子组件的bpm会改变吗\r\n\r\nconst mapStateToProps = (state) => {\r\n    return {\r\n        bpm: selectBpm(state),\r\n        playing: selectPlaying(state)\r\n    }\r\n}\r\nconst mapDispatchToProps = {\r\n    changeProjectBpm,\r\n    play,\r\n    stop\r\n}\r\n\r\n\r\n// 这个组件可以控制bpm和暂停播放\r\nclass ProjectBtn extends Component {\r\n\r\n    changeProjectBpm = (e) => {\r\n        // console.log(e);\r\n        // e.target.value是字符串形式\r\n        this.props.changeProjectBpm(e.target.value * 1)\r\n    }\r\n\r\n    handlePlayStopClick = () => {\r\n        // 当点击的时候，playing是true说明正在播放，那么点击就应该stop\r\n        this.props.playing\r\n            ? this.props.stop()\r\n            : this.props.play()\r\n    }\r\n\r\n    renderPlaying = () => {\r\n        // 如果没有播放就显示播放，等待点击播放\r\n        const className = this.props.playing ? 'stop' : 'play'\r\n        return (\r\n            <button\r\n                className=\"playstop-button button-dark\"\r\n                onClick={this.handlePlayStopClick}\r\n            >\r\n                <div className={className}></div>\r\n            </button >\r\n        )\r\n    }\r\n\r\n\r\n    render() {\r\n        // console.log(this.props);\r\n        return (\r\n            <div className=\"play-bpm\">\r\n                {/* <button onClick={this.changeProjectBpm}>改变bpm</button> */}\r\n\r\n                {this.renderPlaying()}\r\n                <input\r\n                    type=\"number\"\r\n                    className=\"button-dark bpm-input\"\r\n                    min='20'\r\n                    max='400'\r\n                    onChange={(e) => this.changeProjectBpm(e)}\r\n                    value={this.props.bpm}\r\n                />\r\n                <label htmlFor=\"bpm\" className=\"bpm-label\">bpm</label>\r\n\r\n            </div>\r\n        )\r\n    }\r\n}\r\n\r\n\r\nexport default connect(\r\n    mapStateToProps,\r\n    mapDispatchToProps\r\n)(ProjectBtn)\r\n","import React, { Component } from 'react'\r\n\r\n// react-redux\r\nimport { connect } from 'react-redux'\r\n\r\nimport {\r\n    selectBpm,\r\n    selectPlaying,\r\n} from '../../redux/selectors'\r\nimport {\r\n    addNote,\r\n    play,\r\n    stop\r\n} from '../../redux/actions/actions-project'\r\n\r\n// react-dnd\r\nimport {\r\n    // DragSource, \r\n    DropTarget\r\n} from 'react-dnd'\r\nimport ItemTypes from '../../dnd/item-types'\r\n\r\nimport Note from '../note'\r\nimport './index.css'\r\n\r\n// 验证浅拷贝只能对playing这种属性生效，改变了tracks对象这种，要用深拷贝\r\nconst mapStateToProps = (state) => {\r\n    return {\r\n        bpm: selectBpm(state),\r\n        playing: selectPlaying(state)\r\n    }\r\n}\r\nconst mapDispatchToProps = {\r\n    addNote,\r\n    play,\r\n    stop\r\n}\r\n\r\nconst targetCollect = (connect) => {\r\n    return { connectDropTarget: connect.dropTarget() }\r\n}\r\n\r\n// drop的spec配置\r\nconst noteInBucketTarget = {\r\n    hover(props, monitor, component) {\r\n\r\n    },\r\n\r\n\r\n    drop(props, monitor) {\r\n        // const {\r\n        //     noteIndex:\r\n        // }\r\n        const item = monitor.getItem()\r\n        // console.log('noteinbucket', item);\r\n        if (item.source === 'keyboard') {\r\n            props.addNote({\r\n                value: item.value,\r\n                id: props.nextId,\r\n                index: props.index,\r\n                bucketId: props.bucketId,\r\n                trackId: props.trackId\r\n            })\r\n\r\n            // 改变monitor.getItem()的值,可以防抖，只添加一次\r\n            monitor.getItem().value = item.value;\r\n            // 为什么会只添加一次，因为下面的source改成了null\r\n            monitor.getItem().source = null;\r\n            monitor.getItem().noteIndex = props.index;\r\n            monitor.getItem().bucketId = props.bucketId;\r\n            monitor.getItem().id = props.nextId;\r\n            monitor.getItem().trackId = props.trackId;\r\n            // return;\r\n        }\r\n\r\n        // console.log('note-in-bucket', monitor.getDropResult());\r\n\r\n        return {\r\n            note_in_bucket: 1\r\n        }\r\n    },\r\n}\r\n\r\n\r\nclass NoteInBucket extends Component {\r\n\r\n    handlePlayStopClick = () => {\r\n        // 当点击的时候，playing是true说明正在播放，那么点击就应该stop\r\n        this.props.playing\r\n            ? this.props.stop()\r\n            : this.props.play()\r\n    }\r\n\r\n    render() {\r\n        // console.log('NoteInBucket', this.props);\r\n        const {\r\n            value,\r\n            active,\r\n            // 先暂时不做drag 的功能\r\n            // connectDragSource,\r\n            connectDropTarget,\r\n            isDragging,\r\n        } = this.props\r\n\r\n        const opacity = isDragging ? 0 : 1;\r\n\r\n        return connectDropTarget(\r\n            <div className=\"note-in-bucket\" style={{ opacity }}>\r\n                <Note value={value} active={active} />\r\n                {/* <button onClick={this.handlePlayStopClick}></button> */}\r\n            </div>\r\n        )\r\n    }\r\n}\r\n\r\n// 先做drop的功能\r\nconst NoteInBucket_DT = DropTarget(\r\n    ItemTypes.NOTE,\r\n    noteInBucketTarget,\r\n    targetCollect\r\n)(NoteInBucket)\r\n\r\n\r\nexport default connect(\r\n    mapStateToProps,\r\n    mapDispatchToProps\r\n)(NoteInBucket_DT)","import React, { Component } from 'react'\r\nimport { connect } from 'react-redux'\r\nimport { selectNextId } from '../../redux/selectors'\r\n\r\nimport ItemTypes from '../../dnd/item-types'\r\nimport { DropTarget } from 'react-dnd'\r\nimport {\r\n    addNote,\r\n} from '../../redux/actions/actions-project'\r\n\r\nimport NoteInBucket from '../note-in-bucket'\r\n\r\nimport './index.css'\r\n\r\nconst mapStateToProps = (state, ownProps) => {\r\n    return { nextId: selectNextId(ownProps.trackId)(state) }\r\n}\r\nconst mapDispatchToProps = { addNote }\r\n\r\n\r\nclass Bucket extends Component {\r\n    render() {\r\n\r\n        // console.log('bucket',this.props);\r\n        // 添加note后这里的props没有更新，这里不是上面传下来的吗\r\n        // 难道是浅拷贝的关系，对象里有对象\r\n        const {\r\n            notes,\r\n            currentNote,\r\n            bucketId,\r\n            trackId,\r\n            nextId,\r\n            connectDropTarget\r\n        } = this.props\r\n\r\n        // 播放的当前音符，是否处于这个bucket，用来判断当前拍子是否高亮\r\n        let styleName = currentNote[0] === bucketId\r\n            ? 'bucket bucket-playing'\r\n            : 'bucket'\r\n\r\n        const Notes = notes.map((note, i) => {\r\n            // 判断当前音符是否高亮，要看当前拍子是否高亮而且是否到了当前音符\r\n            let active = currentNote[0] === bucketId && currentNote[1] === i;\r\n            return (\r\n                <NoteInBucket\r\n                    value={note.value}\r\n                    active={active}\r\n                    index={i}\r\n                    key={i}\r\n                    id={note.id}\r\n                    bucketId={bucketId}\r\n                    nextId={nextId}\r\n                    trackId={trackId}\r\n                />\r\n            )\r\n        })\r\n        return connectDropTarget(\r\n            <div className={styleName}>\r\n                {Notes}\r\n            </div>\r\n        )\r\n    }\r\n}\r\n\r\nconst bucketTarget = {\r\n    // 返回的对象可以在monitor.getDropResult()中取到\r\n    drop(props, monitor) {//这个props是从父组件传进来的的\r\n        /* \t\r\n        如果某个drop target处理了drop 事件。则返回true，否则返回false。\r\n        即使 target 没有返回 drop 结果，didDrop() 也会返回true。 \r\n        在 endDrag() 中使用它来测试任何放置目标是否已处理掉落。\r\n        如果在 endDrag() 之外调用，则返回 false \r\n        */\r\n        // monitor.didDrop()如果这个存在，即有其他target处理了这个事件\r\n\r\n        // 因为bucket和note-in-bucket在一起，所以要先取消一个\r\n        // console.log('bucket', monitor.getDropResult());\r\n\r\n        if (monitor.didDrop())\r\n            return\r\n        console.log('bucketgetItem', monitor.getItem());\r\n        const item = monitor.getItem()\r\n        const { value } = item\r\n        const { bucketId, trackId, nextId, length } = props\r\n        if (item.source === 'keyboard')\r\n            props.addNote({\r\n                value,\r\n                bucketId,\r\n                trackId,\r\n                id: nextId,\r\n                index: length\r\n            })\r\n        // 返回一个对象，在noteInKeyboard里面drop的时候，进行判断是否addNote\r\n\r\n        // return {\r\n        //     target: 'bucket',\r\n        //     bucketId: props.bucketId,\r\n        //     trackId: props.trackId,\r\n        //     nextId: props.nextId,\r\n        //     length: props.notes.length\r\n        // }\r\n    }\r\n}\r\n\r\n\r\nconst collect = (connect) => {\r\n    return {\r\n        connectDropTarget: connect.dropTarget()\r\n    }\r\n}\r\n\r\n// 放入drop环境中\r\nconst dt_Bucket = DropTarget(\r\n    ItemTypes.NOTE,\r\n    bucketTarget,\r\n    collect\r\n)(Bucket)\r\n\r\n// 放入redux环境中\r\nexport default connect(\r\n    mapStateToProps,\r\n    mapDispatchToProps\r\n)(dt_Bucket)","import React, { Component } from 'react'\r\nimport Bucket from '../bucket'\r\n\r\nimport { connect } from 'react-redux'\r\nimport {\r\n    deleteBucket\r\n} from '../../redux/actions/actions-project'\r\n\r\nimport './index.css'\r\n\r\nclass BucketContainer extends Component {\r\n\r\n    deleteBtn = () => {\r\n        // console.log(this.props);\r\n        const { bucketId, trackId } = this.props\r\n        this.props.deleteBucket({\r\n            bucketId,\r\n            trackId\r\n        })\r\n    }\r\n\r\n    render() {\r\n        return (\r\n            <div className=\"bucket-container\">\r\n                <Bucket {...this.props} />\r\n                <button\r\n                    onClick={this.deleteBtn}\r\n                    className='delete-bucket button-dark'>\r\n                    ✖\r\n                </button>\r\n            </div>\r\n        )\r\n    }\r\n}\r\n\r\nconst mapStateToProps = null\r\nconst mapDispatchToProps = { deleteBucket }\r\n\r\nexport default connect(\r\n    mapStateToProps,\r\n    mapDispatchToProps\r\n)(BucketContainer)\r\n","import React, { Component } from 'react'\r\nimport BucketContainer from '../bucketContainer'\r\nimport { connect } from 'react-redux'\r\n\r\nimport {\r\n    addBucket\r\n} from '../../redux/actions/actions-project'\r\nimport './index.css'\r\n\r\nclass BucketRow extends Component {\r\n\r\n\r\n    handleAddBucketClick = () => {\r\n        const {id,addBucket} = this.props\r\n        addBucket(id)\r\n    }\r\n    render() {\r\n        const { sequence, currentNote, id } = this.props\r\n        //#region \r\n        /* sequence中的bucket其实就是各个音块的数组\r\n        比如：\r\n        sequence:[\r\n            [\r\n                {id: 13,value: 'rest'},\r\n                {id: 16,value: 'rest'},\r\n                {id: 11,value: 'rest'},\r\n                {id: 14,value: 'B5'}\r\n            ],\r\n            [ { id: 15, value: 'E6' } ],\r\n            [],\r\n            [],\r\n            ]\r\n\r\n        所以notes:[\r\n                {id: 13,value: 'rest'},\r\n                {id: 16,value: 'rest'},\r\n                {id: 11,value: 'rest'},\r\n                {id: 14,value: 'B5'}\r\n            ]\r\n        应该是一个数组，可以当做各个note组成notes\r\n        */\r\n        //#endregion\r\n        const Buckets = sequence.map((bucket, i) => {\r\n            return (\r\n                <BucketContainer\r\n                    notes={bucket}\r\n                    currentNote={currentNote}\r\n                    key={i}\r\n                    bucketId={i}\r\n                    trackId={id}\r\n                />\r\n            )\r\n        })\r\n        return (\r\n            <div className='bucketrow'>\r\n                {Buckets}\r\n\r\n                <button\r\n                    onClick={this.handleAddBucketClick}\r\n                    className=\"button-light bucketrow-button\"\r\n                    title=\"add bucket\"\r\n                >\r\n                    +\r\n      </button>\r\n            </div>\r\n        )\r\n    }\r\n}\r\nconst mapDispatchToProps = {addBucket}\r\nexport default connect(\r\n    null,\r\n    mapDispatchToProps\r\n)(BucketRow)\r\n","import React, { Component } from 'react'\r\nimport BucketRow from '../bucketRow'\r\nimport { connect } from 'react-redux'\r\nimport { selectTrack } from '../../redux/selectors'\r\n\r\n\r\n//把这个track传入\r\nconst mapStateToProps = (state, ownProps) => {\r\n    return selectTrack(ownProps.id)(state)\r\n}\r\n\r\nclass Track extends Component {\r\n    render() {\r\n        const { currentNote, sequence, id } = this.props\r\n        return (\r\n            <div>\r\n                <BucketRow\r\n                    // 音序器\r\n                    sequence={sequence}\r\n                    currentNote={currentNote}\r\n                    id={id}\r\n                />\r\n            </div>\r\n        )\r\n    }\r\n}\r\nexport default connect(\r\n    // null,\r\n    mapStateToProps,\r\n    null\r\n)(Track)","import React, { Component } from 'react'\r\nimport { connect } from 'react-redux'\r\nimport { addTrack } from '../../redux/actions/actions-project'\r\n\r\nimport { selectTracks } from '../../redux/selectors'\r\nimport Track from '../track'\r\nimport './index.css'\r\n\r\n\r\nconst mapStateToProps = (state) => {\r\n    return {\r\n        tracks: selectTracks(state)\r\n    }\r\n}\r\n\r\nconst mapDispatchToProps = { addTrack }\r\n\r\n\r\nclass Tracks extends Component {\r\n    render() {\r\n\r\n        // 把每条track显示出来\r\n        const TrackMsg = Object.values(this.props.tracks).map(track => {\r\n            // 判断sequence有没有值，如果是后续连续删除bucket，删完后应该不加载该条sequence\r\n            // 或者在deleteBucket的reducer里面进行判断\r\n            if(track.sequence.length!==0){\r\n                // 只有当sequence的length不为0 的时候才进行渲染\r\n                // 给每个组价传入id\r\n                return (\r\n                    <Track id={track.id} key={track.id} />\r\n                )\r\n            }\r\n            // 否则就返回一个空的div，而且要传入id，key等\r\n            return <div id={track.id} key={track.id}></div>\r\n        })\r\n\r\n        return (\r\n            <div className='tracks'>\r\n                {TrackMsg}\r\n                <button\r\n                    onClick={this.props.addTrack}\r\n                    className=\"button-dark tracks-new\"\r\n                    title=\"create new track\"\r\n                >+</button>\r\n            </div>\r\n        )\r\n    }\r\n}\r\n\r\nexport default connect(\r\n    mapStateToProps,\r\n    mapDispatchToProps\r\n)(Tracks)","import React, { Component } from 'react'\r\nimport './index.css'\r\n\r\nexport default class EditableText extends Component {\r\n\r\n    // 定义state\r\n    state = {\r\n        // 是否处于编辑状态\r\n        editing: false,\r\n        value: this.props.value,\r\n    }\r\n\r\n    handleClick = () => {\r\n        this.setState({\r\n            editing: true,\r\n            value: this.props.value,\r\n        })\r\n    }\r\n\r\n    handleSubmit = (event) => {\r\n        // 阻止当前表单的提交\r\n        event.preventDefault();\r\n        this.handleBlur()\r\n    }\r\n\r\n    handleBlur = () => {\r\n        // console.log(this.props);\r\n        this.state.value !== ''\r\n            ? this.props.onBlur(this.state.value)\r\n            : this.setState({ value: this.props.value })\r\n        this.setState({\r\n            editing: false\r\n        })\r\n    }\r\n\r\n    handleChange = (event) => {\r\n        this.setState({\r\n            value: event.target.value\r\n        })\r\n    }\r\n\r\n    // 让焦点到input内\r\n    focusInput = () => {\r\n        this.textInput.focus()\r\n        // 所以用focus只是有焦点，但用select 会选中该文本框里的所有文本\r\n        this.textInput.select()\r\n    }\r\n\r\n    // 当点击后需要预先把焦点放入修改框input中，而不是再次点击才能进入\r\n    componentDidUpdate(preProps, preState) {\r\n        // 如果上一次的state中editing是false并且这次是true\r\n        if (!preState.editing && this.state.editing) {\r\n            this.focusInput()\r\n        }\r\n    }\r\n\r\n    render() {\r\n        // 为什么更新过后state没有变\r\n        const { value, title } = this.props\r\n        const { editing } = this.state\r\n\r\n        // 如果处于编辑状态\r\n        if (editing) {\r\n            return (\r\n                <form onSubmit={this.handleSubmit}>\r\n                    <input\r\n                        type=\"text\"\r\n                        name='input'\r\n                        title={title}\r\n                        className='editable-text editable-text-input'\r\n                        // value={value}\r\n                        value={this.state.value}\r\n                        onBlur={this.handleBlur}\r\n                        onChange={this.handleChange}\r\n                        ref={input => { this.textInput = input }}\r\n                    />\r\n                </form>\r\n            )\r\n        } else {\r\n            return (\r\n                <div\r\n                    className=\"editable-text editable-text-div\"\r\n                    onClick={this.handleClick}\r\n                >\r\n                    <span title={title}>{value}</span>\r\n                </div>\r\n            )\r\n        }\r\n    }\r\n}\r\n","import React, { Component } from 'react'\r\nimport ProjectBtn from '../project-btn'\r\nimport Tracks from '../tracks'\r\n\r\n//react-redux相关\r\nimport { connect } from 'react-redux'\r\nimport {\r\n    changeProjectName,\r\n    initProject,\r\n    toSpeed_fuTure_,\r\n    toMario,\r\n} from '../../redux/actions/actions-project'\r\n\r\n// react-dnd相关\r\nimport { DropTarget } from 'react-dnd'\r\nimport ItemTypes from '../../dnd/item-types'\r\n\r\nimport EditableText from '../editable-text'\r\n\r\n// 引入antd\r\nimport { Button, } from 'antd';\r\nimport {\r\n    EditOutlined,\r\n    SaveOutlined\r\n} from '@ant-design/icons';\r\n// css\r\nimport './index.css'\r\n\r\n\r\n// 把store中的state全部解构传进去，内部props接收就是project的解构形式\r\nconst mapStateToProps = (state) => ({ ...state })\r\n// 简写形式\r\nconst mapDispatchToProps = {\r\n    changeProjectName,\r\n    initProject,\r\n    toSpeed_fuTure_,\r\n    toMario,\r\n}\r\n\r\nconst spec = {\r\n    drop(props, monitor, component) {\r\n        // const item = monitor.getItem()\r\n        // console.log('我是item', item);\r\n        // 这里 return 出去的对象属性自行选择，这里只是用 id 作为演示\r\n        return { id: props.id }\r\n    }\r\n}\r\n\r\n// collect中的可以传给当前drop组件为props\r\nconst collect = (connect, monitor) => {\r\n    const item = monitor.getItem()\r\n    // console.log('我是item', item);\r\n    return {\r\n        connectDropTarget: connect.dropTarget(),\r\n        item,\r\n        monitor\r\n    }\r\n}\r\n\r\n\r\nclass Project extends Component {\r\n\r\n    state = {\r\n        value: this.props.name\r\n    }\r\n\r\n    // 打印store\r\n    // logStore = () => {\r\n    //     console.log(this.props);\r\n    // }\r\n\r\n    // 新建空白乐章，就是把redux里的store都改了。相当于初始化\r\n    initProject = () => {\r\n        this.props.initProject()\r\n    }\r\n\r\n    // 换成体验曲目2\r\n    changeToSpeed_fuTure_ = () => {\r\n        this.props.toSpeed_fuTure_()\r\n    }\r\n    // 换成体验曲目2\r\n    changeToMario = () => {\r\n        this.props.toMario()\r\n    }\r\n\r\n\r\n\r\n    render() {\r\n        const { connectDropTarget } = this.props\r\n        // 测试dnd能携带的obj\r\n        // const { monitor } = this.props\r\n        // console.log(monitor.getItem());\r\n        // let item = monitor.getItem()?monitor.getItem():null\r\n        // console.log('project',this.props);\r\n        return connectDropTarget(\r\n            <div\r\n                className='project'//让project撑满左边的css样式\r\n            >\r\n                {/* 测试dnd能携带的obj是什么{item} */}\r\n                {/* {\r\n                    monitor.getItem()?monitor.getItem():null\r\n                } */}\r\n                <div className=\"project-header\">\r\n                    <div className=\"project-title\">\r\n\r\n                        <EditableText\r\n                            value={this.props.name}\r\n                            title='编辑项目名称'\r\n                            onBlur={value => { this.props.changeProjectName(value) }}\r\n                        />\r\n                    </div>\r\n                    {/* 这样传递就是全部store传进去了，可以不这样传，练习redux */}\r\n                    {/* <ProjectBtn {...this.props} /> */}\r\n\r\n                    <ProjectBtn />\r\n\r\n                    <br />\r\n                    {/* <Button\r\n                        icon={<SaveOutlined />}\r\n                        size='small'\r\n                        onClick={this.logStore}\r\n                    >保存</Button> */}\r\n                    <br />\r\n                    {/* <Button\r\n                        icon={<SaveOutlined />}\r\n                        size='small'\r\n                        onClick={this.changeToMario}\r\n                    >体验曲目1 mario</Button>\r\n                    <br /> */}\r\n                    <Button\r\n                        icon={<SaveOutlined />}\r\n                        size='small'\r\n                        onClick={this.changeToSpeed_fuTure_}\r\n                    >体验曲目2 寄生兽bgm</Button>\r\n                    {/* <br /> */}\r\n                    <Button\r\n                        icon={<EditOutlined />}\r\n                        size='small'\r\n                        onClick={this.initProject}\r\n                    >新建空白乐章</Button>\r\n                </div>\r\n                <Tracks />\r\n            </div>\r\n        )\r\n    }\r\n}\r\n\r\n\r\nconst dt_Project = DropTarget(\r\n    ItemTypes.NOTE,\r\n    spec,\r\n    collect\r\n)(Project)\r\n\r\nexport default connect(\r\n    mapStateToProps,\r\n    mapDispatchToProps\r\n)(dt_Project)\r\n","import React, { Component } from 'react'\r\n\r\n//引入组件 \r\nimport Header from '../header'\r\nimport Footer from '../footer'\r\nimport NoteColumn from '../note-column'\r\nimport Project from '../project'\r\n\r\n// 引入redux相关\r\nimport {connect} from 'react-redux'\r\n// import {bindActionCreators} from 'redux'\r\n// 引入action\r\n\r\n\r\n// 引入dnd拖拽模块相关的,好像已经不是这样用的了\r\n// import {DragDropContext} from 'react-dnd'\r\n// import HTML5Backend from 'react-dnd-html5-backend'\r\n\r\n// 确实不像上面那样引入了\r\nimport {DndProvider} from 'react-dnd'\r\nimport {HTML5Backend} from 'react-dnd-html5-backend'\r\n\r\n// 引入css样式\r\nimport './index.css'\r\n\r\n\r\n// 不用考虑登录功能，所以直接就是渲染ui页面\r\n class App extends Component {\r\n    render() {\r\n        return (\r\n            <div className='app'>\r\n                <Header/>\r\n                <div className='wrapper'>\r\n                <NoteColumn/>\r\n                <Project/>\r\n                </div>\r\n                <Footer/>\r\n            </div>\r\n        )\r\n    }\r\n}\r\n\r\n// 给App封装拖拽环境\r\nclass ddc_App extends Component{\r\n    render(){\r\n        return(\r\n            <DndProvider backend={HTML5Backend}>\r\n                <App/>\r\n            </DndProvider>\r\n        )\r\n    }\r\n}\r\n\r\n// 给封装好拖拽环境的DndApp连接redux然后导出到入口index.js文件\r\nexport default connect(\r\n    null,\r\n    null\r\n)(ddc_App)","// 该observeStore函数需要返回一个函数，用于控制监听函数的关闭\r\n// eslint-disable-next-line\r\nexport default function (store, selector, onChange) {\r\n    // currentState用来判断后续的newState是否发生改变，\r\n    // 因为currentState是undefined如果未改变，说明newState也是undefined\r\n    // 则说明是新建空白project\r\n    let currentState//undefined\r\n    const handleChange = () => {\r\n        let newState//undefined\r\n        try {\r\n            // 获取新状态,通过传进来的selector函数，给它传进store的state\r\n            // 这里是不是也得考虑深浅拷贝的问题\r\n            newState = selector(store.getState())\r\n            // console.log('selector',selector);\r\n            // console.log('newState',newState);\r\n        } catch (error) {//在监听取消的时候，handleChange还会执行一次，就会报错\r\n            // 如果发生error，直接跳出整个observeStore函数\r\n            // console.log(selector);\r\n            // console.log(newState);\r\n            // console.log(error);\r\n            return\r\n        }\r\n\r\n        // 这样看肯定不等啊，因为currentState没定义是什么，除非newState也是undefined\r\n        // 所以什么时候newState是undefined，当新建一个project的时候，什么也没有\r\n        // 比如：let project = {}  console.log(project.l); 这个就会输出undefined\r\n        if (newState !== currentState) {// 所以这个意思就是当project不是新建的时候\r\n            onChange(newState, currentState);\r\n\r\n            // 这有什么用，后续也没有把currentState进行任何操作，\r\n            /*\r\n              因为这个函数是监听器，一旦sequence的实例被创建，那么这个observeStore就形成闭包\r\n              不会消失，直到执行unsubscribe，所以第一次的currentState是undefined，\r\n              但是，在没取消监听之前，后续的change操作都会让newState和currentState进行比较\r\n              所以必须每次给currentState = newState，不然每次都是newState跟undefined比较\r\n            */\r\n            currentState = newState;\r\n        }\r\n    }\r\n\r\n    // 运行handleChange，得到\r\n    handleChange()\r\n\r\n    // store.subscribe可以监听变化，\r\n    // 一旦store的state发生变化，就会调用传入的函数handleChange\r\n    // store.subscribe()会返回一个函数，调用该函数就可以取消监听\r\n    let unsubscribe = store.subscribe(handleChange)\r\n\r\n    // 当unsubscribe()的时候，store.subscribe(handleChange)(),handleChange会执行,所以要try catch\r\n    return unsubscribe;\r\n}","import * as Tone from 'tone'\r\nimport {\r\n    selectSequence,\r\n    selectTrack,\r\n\r\n} from '../redux/selectors'\r\nimport { createPartEvents } from './utils';\r\nimport { updateCurrentNote } from '../redux/actions/actions-project';\r\nimport observeStore from '../redux/observers'\r\n// import observerStore from '../redux/observers'\r\n\r\nexport default class Track {\r\n    constructor(store, id) {\r\n        this.store = store\r\n        this.id = id\r\n        // console.log(id);\r\n        const { sequence, baseNote, synth } = selectTrack(id)(store.getState())\r\n\r\n        this.sequence = sequence;\r\n\r\n        this.baseNote = baseNote;\r\n\r\n        this.filter = new Tone.Filter(20000, 'lowpass', -96).toMaster();\r\n        // this.filter = new Tone.Filter(20000, 'lowpass', -96).toMaster();\r\n        // this.filter = new Tone.Filter(20000, 'lowpass', -96).toDestination();\r\n\r\n        this.synth = new Tone.Synth({\r\n            envelope: synth.envelope,\r\n            oscillator: synth.oscillator\r\n        }).connect(this.filter);\r\n\r\n        this.part = this.initPart(sequence, baseNote);\r\n\r\n        // console.log('volume',this.synth.volume.value );\r\n        // 初始音量为0，但是太大了。在这里先改一下，0并不是静音\r\n        this.synth.volume.value = -8\r\n        // console.log('volume',this.synth.volume.value );\r\n\r\n        // 给sequence添加监听器，一旦新加入note或者删除之类的操作，就重新加载sequence\r\n        this.subscriptions = [\r\n            // 这个监听器写了过后会导致部分不能播放，查一下bug，查出来了因为在reducer里面是所有都深拷贝，\r\n            // 所以只要是有action的都会改变sequence，比如在下面partProcessor里面的updateCurrentNote就会改变\r\n            // 解决办法是在reducer里面按情况进行深浅拷贝，分类，不要每次都深拷贝\r\n            observeStore(store,\r\n                selectSequence(id),\r\n                this.onSequenceChange),\r\n        ]\r\n\r\n\r\n        // console.log('part',this.part.removeAll);\r\n        // console.log('part',this.part);\r\n\r\n    }\r\n\r\n    initPart(sequence, baseNote) {\r\n        const part = new Tone.Part(\r\n            this.partProcessor.bind(this),\r\n            createPartEvents(sequence, baseNote)\r\n        );\r\n\r\n        // 0表示立刻开始start该part\r\n        part.start(0);\r\n        // 设定为true就会一直重复，立刻执行，如果设定为大于1的数值，就会执行n次\r\n        part.loop = true;\r\n        // loopEnd的节点取决于设定为true的时候\r\n        part.loopEnd = `${sequence.length}*0:${(baseNote / 4)}`;\r\n\r\n        return part;\r\n    }\r\n    // initPart = (sequence, baseNote) => {\r\n    //     const part = new Tone.Part(\r\n    //         this.partProcessor.bind(this),\r\n    //         createPartEvents(sequence, baseNote)\r\n    //     );\r\n    //     // const part = new Tone.Part(((time, value) => {\r\n    //     //     // the value is an object which contains both the note and the velocity\r\n    //     //     console.log(time,value);\r\n    //     //     console.log(`${sequence.length}*0:${(baseNote / 4)}`);\r\n    //     //     this.synth.triggerAttackRelease(value.note, \"8n\", time, value.velocity);\r\n    //     // }), [{ time: 0, note: \"C3\", velocity: 0.9 },\r\n    //     // { time: \"0:2\", note: \"C4\", velocity: 0.5 }\r\n    //     // ]);\r\n\r\n    //     // 0表示立刻开始start该part\r\n    //     part.start(0);\r\n    //     // 设定为true就会一直重复，立刻执行，如果设定为大于1的数值，就会执行n次\r\n    //     part.loop = true;\r\n    //     // loopEnd的节点取决于设定为true的时候\r\n    //     part.loopEnd = `${sequence.length}*0:${(baseNote / 4)}`;\r\n\r\n    //     return part;\r\n    // }\r\n    /* \r\n    const part = new Tone.Part( ( (time,note) => { } ), [] )\r\n    \r\n    */\r\n    // 如何保证value传进来的是有值的,要改这个函数，还有utils里面的数组\r\n    partProcessor(time, { value, dur, bucketIndex, noteIndex }) {\r\n        // only trigger a note if it's not a rest, but dispatch currentNote in either case\r\n        // 只要不是rest都会走后面这条triggerAttackRelease，相对于是个if判断了\r\n        // console.log('part', time + '  ' + value + '  ' + dur);\r\n        value !== 'rest' && this.synth.triggerAttackRelease(value, dur, time);//这些参数从Part的后一个参数里面返回来\r\n\r\n        // 更改CurrentNote，当前的音符，是用来显示播放的note不同样式，在bucket组件里面\r\n        // 并且，在播放完上一次的note后要跳到下一次的note，然后\r\n        // 不要让这个action 的reducer去深拷贝，改变了sequence，\r\n        // 但是不深拷贝，进入不到那一层，sequence在更深一层，必须要拷贝到目标层位\r\n        this.store.dispatch(\r\n            updateCurrentNote({ bucketId: bucketIndex, noteIndex, trackId: this.id })\r\n        );\r\n    }\r\n\r\n    deleteSelf() {\r\n        // console.log('deleteSelf');\r\n        // 解除监听\r\n        // unsubscribe from all subscriptions\r\n        this.subscriptions.forEach(unsubscribe => unsubscribe());\r\n\r\n        // console.log('deleteSelf12313');\r\n        // 处理合成器\r\n        // dispose of the synth\r\n        this.synth.dispose();\r\n        this.synth = null;\r\n\r\n        // dispose of the part\r\n        this.part.dispose();\r\n        this.part = null;\r\n    }\r\n\r\n    // sequence发生改变就执行\r\n    onSequenceChange = (sequence) => {\r\n        // console.log('sequencechange');\r\n        // console.log('part', this.part);\r\n        this.part.removeAll()\r\n        this.part = this.initPart(sequence, this.baseNote)\r\n        this.sequence = sequence\r\n    }\r\n}","export function createPartEvents(sequence, baseNote) {\r\n  const events = [];\r\n  const arg = []\r\n  // place a dummy 'rest' note in any empty bucket\r\n  // this ensures that a previously played note doesn't light up in the view\r\n  const mappedSequence = sequence.map(bucket => {\r\n    if (bucket.length < 1)\r\n      return [{ value: 'rest' }];\r\n    return bucket;\r\n  });\r\n  mappedSequence.forEach((bucket, bucketIndex) => {\r\n    bucket.forEach(({ value }, noteIndex) => {\r\n      const [dur, time] =\r\n        getDurAndTime(bucket.length, bucketIndex, noteIndex, baseNote);\r\n      // events.push({ time, value, dur });\r\n      events.push({ time, value, dur, noteIndex, bucketIndex });\r\n      arg.push({ noteIndex, bucketIndex })\r\n    });\r\n  });\r\n  // console.log('events', events);\r\n  // event\r\n  return events;\r\n  // return [events, arg];\r\n}\r\n\r\nfunction getDurAndTime(bucketLength, bucketIndex, noteIndex, baseNote) {\r\n  const _dur = (baseNote / 4) / bucketLength;\r\n  const dur = `0:${_dur}`;\r\n  const start = `0:${bucketIndex * (baseNote / 4)}`;\r\n  // 我觉得是这个time出了问题，好像现版本不能 字符串+了,确实是高版本已经换了，不用这种方式\r\n  const time = `${start} + 0:${noteIndex * _dur}`;\r\n  return [dur, time];\r\n}\r\n","// React相关\nimport React from 'react';\nimport ReactDOM from 'react-dom';\n\n// Redux相关\nimport { Provider } from 'react-redux'\nimport store from './redux/store'\n\n\n//css相关 \nimport 'normalize.css'//生效了\n// 这里引入了antd的css覆盖了之前的css，要注意\nimport \"antd/dist/antd.css\";\nimport './index.css';\n\n// 引入主模块App入口,经过路由导入\nimport App from './components/app';\n\n// 引入Tone，用来Tone.context.resume();\nimport * as Tone from 'tone'\n\n\n// 引入Sequencer构造函数\nimport Sequencer from './sequencer'\n\n\n// // 创建Sequencer实例，并传入store，保证播放系统有所响应\nnew Sequencer(store)\n// 确保Tone的AudioContext模块在一开始能够运行而不被禁止  https://github.com/Tonejs/Tone.js/issues/341\ndocument.documentElement.addEventListener('mousedown', () => {\n  if (Tone.context.state !== 'running')\n    Tone.context.resume();\n});\n// console.log(process.env.NODE_ENV);\n\nReactDOM.render((\n  // 传入store\n  <Provider store={store}>\n    <App/>\n  </Provider>\n\n), document.getElementById('root'));\n","import * as Tone from 'tone'\r\nimport {\r\n    selectTestNote,\r\n    selectTracks,\r\n    selectPlaying,\r\n    selectProjectIdAndTrackCount,\r\n    selectBpm,\r\n} from '../redux/selectors'\r\nimport Track from './track'\r\n\r\nimport observeStore from '../redux/observers'\r\n\r\n// 一个音序器的构造函数，会传一个store的参数，通过改变redux的store\r\n// 进行监听store 的变化，做出相应的播放等操作\r\nexport default class Sequencer {\r\n    // 接收redux 的store作为参数,\r\n    // 因为这不是react的类，并不是extends Component，所以需要自己用构造器来定义传进来的参数\r\n    constructor(store) {\r\n        // 把store存进来\r\n        this.store = store\r\n        this.tracks = [];\r\n        \r\n        // 新建一个合成器，播放的时候需要这个\r\n        this.synth = new Tone.Synth().toMaster()\r\n        // this.synth = new Tone.Synth().toDestination()\r\n\r\n\r\n        // 在这里把selectBPM添加进来就可以了\r\n        Tone.Transport.bpm.value = store.getState().bpm\r\n        // console.log('bpm',Tone.Transport.bpm.value);\r\n\r\n\r\n        // 新建一个监听器，一旦store发生改变就做出响应,监听器函数需要自己定义\r\n        // 在外部可以通过subscriptions[i]()来取消监听\r\n        this.subscriptions = [\r\n            observeStore(store, selectTestNote, this.handleTestNoteChange.bind(this)),\r\n            observeStore(store, selectPlaying, this.handlePlayingChange.bind(this)),\r\n            observeStore(store, selectBpm, this.handleBpmChange),\r\n            observeStore(\r\n                store,\r\n                selectProjectIdAndTrackCount,\r\n                this.handleProjectIdOrTrackCountChange.bind(this)\r\n            )\r\n\r\n            // 为什么要用bind，是因为这是在constructor里面定义的，所以没有this\r\n            // 就像在里面定义state要加this一样，在外部的话就不需要加bind了\r\n            // observerStore(store, selectTestNote, this.handleTestNoteChange)\r\n        ]\r\n        // this.generateTracks()\r\n    }\r\n\r\n    // 给我整不会了\r\n    // constructor(store){\r\n    //     console.log(store);\r\n    //     this.store = store\r\n    // }\r\n    // static synth = new Tone.Synth().toDestination()\r\n    // static subscriptions = [\r\n    //     observerStore(this.store, selectTestNote, this.handleTestNoteChange)\r\n    // ]\r\n\r\n    handlePlayingChange(playing) {\r\n        playing\r\n            ? Tone.Transport.start('+0.1')//延迟0.1s播放\r\n            : Tone.Transport.stop();\r\n    }\r\n\r\n    handleBpmChange = (bpm) => {\r\n        Tone.Transport.bpm.value = bpm;\r\n    }\r\n\r\n    handleTestNoteChange = ({ on, value }) => {\r\n        on\r\n            ? this.synth.triggerAttack(value)\r\n            : this.synth.triggerRelease()\r\n    }\r\n\r\n    // 会自动调用，因为在observe监听器里面调用了\r\n    handleProjectIdOrTrackCountChange() {\r\n        // console.log('gaibianle');\r\n        // 删除这些实例\r\n        this.tracks.forEach(track => { track.deleteSelf(); });\r\n        // 如果我删除后就关闭那个监听器不就行了？\r\n        // 但是deleteSelf在内部已经做了删除操作\r\n\r\n        this.tracks = this.generateTracks();\r\n    }\r\n\r\n    // 生成tracks的音轨\r\n    generateTracks() {\r\n        // console.log('MMM');\r\n        return Object.values(selectTracks(this.store.getState()))\r\n            // 解构出id\r\n            .map(({ id }) => {\r\n                // console.log('id', id);\r\n                return new Track(this.store, id);\r\n            });\r\n    }\r\n\r\n}"],"sourceRoot":""}